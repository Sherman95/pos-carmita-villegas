<div class="catalog-page">
	<div class="header">
		<div>
			<div class="title">Servicios</div>
			<div class="subtitle">Agrega, edita y Ãºsalos en la venta</div>
		</div>
		<div class="header-actions">
			<button mat-flat-button color="primary" (click)="nuevoServicio()">
				<mat-icon>add</mat-icon>
				Nuevo servicio
			</button>
			<button mat-stroked-button color="primary" (click)="seedServicios()">Cargar servicios sugeridos</button>
			<button mat-button color="primary" (click)="irAlHistorial()">
				<mat-icon>history</mat-icon>
				Historial diario
			</button>
		</div>
	</div>

	<div class="toolbar">
		<mat-form-field appearance="outline" class="search-field">
			<mat-label>Buscar servicio</mat-label>
			<mat-icon matPrefix>search</mat-icon>
			<input matInput type="text" placeholder="Nombre" [ngModel]="searchTerm()" (ngModelChange)="setSearch($event)" />
		</mat-form-field>
	</div>

	<div class="catalog-grid">
		@for (item of filteredItems(); track item.id) {
			<mat-card class="item-card">
				<div class="card-content">
					<div class="info">
						<span class="nombre">{{ item.nombre }}</span>
						<span class="badge servicio">SERVICIO</span>
					</div>
					<div class="precio">${{ item.precio }}</div>
				</div>
				<div class="actions">
					<button mat-button (click)="seleccionar(item.id)">Editar</button>
					<button mat-stroked-button color="primary" (click)="abrirDialogoPrecio(item)">Agregar a venta</button>
				</div>
			</mat-card>
		} @empty {
			<p class="no-items">No hay servicios. Usa "Cargar servicios sugeridos" o agrega uno nuevo.</p>
		}
	</div>

		<ng-template #serviceFormDialog>
			<h2 mat-dialog-title>{{ selectedId() ? 'Editar servicio' : 'Nuevo servicio' }}</h2>
			<mat-dialog-content class="dialog-content">
				<div class="form-sub">Completa nombre y precio para guardar.</div>
				<div class="form-grid dialog-grid">
					<mat-form-field appearance="outline">
						<mat-label>Nombre</mat-label>
						<input matInput [ngModel]="form().nombre" (ngModelChange)="updateField('nombre', $event)" />
					</mat-form-field>

					<mat-form-field appearance="outline">
						<mat-label>Precio</mat-label>
						<input matInput type="number" [ngModel]="form().precio" (ngModelChange)="updateField('precio', +$event)" />
					</mat-form-field>
				</div>
			</mat-dialog-content>
			<mat-dialog-actions align="end" class="dialog-actions">
				<button mat-stroked-button color="warn" mat-dialog-close (click)="cancelar()">Cancelar</button>
				<button mat-flat-button color="primary" (click)="guardar()" [disabled]="!form().nombre">{{ selectedId() ? 'Actualizar' : 'Guardar' }}</button>
			</mat-dialog-actions>
		</ng-template>
</div>