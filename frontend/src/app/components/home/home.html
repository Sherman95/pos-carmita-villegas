<div class="home">
  <section class="hero">
    <div class="hero-copy">
      <div class="badge">Caja</div>
      <h1>Punto de venta</h1>
      <p class="subtitle">Elige cliente y arranca la sesión de cobro con un clic.</p>
      <div class="pill">Listo para cobrar</div>
    </div>

    <mat-card class="hero-card">
      <div class="card-title">Cliente de la venta</div>
      <div class="card-subtitle">Puedes dejar "Consumidor final" si no deseas asociar.</div>
      
      <div class="form-row">
        
        <mat-form-field appearance="outline" class="client-field">
          <mat-label>Buscar Cliente</mat-label>
          
          <input type="text"
                 matInput
                 placeholder="Escribe nombre o cédula..."
                 [ngModel]="searchText()"
                 (ngModelChange)="searchText.set($event)"
                 [matAutocomplete]="auto"
                 (focus)="limpiarBusqueda()">

          @if (searchText() && searchText() !== 'Consumidor Final') {
            <button mat-icon-button matSuffix (click)="searchText.set(''); $event.stopPropagation()">
                <mat-icon>close</mat-icon>
            </button>
          }

          <mat-autocomplete #auto="matAutocomplete" (optionSelected)="onOptionSelected($event)">
            
            <mat-option value="anon">
              <mat-icon>person_outline</mat-icon>
              <span>Consumidor Final</span>
            </mat-option>

            <mat-divider></mat-divider>

            @for (c of filteredClients(); track c.id) {
              <mat-option [value]="c">
                <span style="font-weight: 500;">{{ c.nombre }}</span>
                <small style="color: gray; margin-left: 8px;">{{ c.cedula }}</small>
              </mat-option>
            }

            @if (filteredClients().length === 0 && searchText()) {
              <mat-option disabled>No se encontraron resultados</mat-option>
            }
          </mat-autocomplete>
        </mat-form-field>
        <button mat-flat-button color="primary" class="cta" (click)="irAVenta()">
          <mat-icon>point_of_sale</mat-icon>
          Ir a cobrar
        </button>
      </div>
      
      <div class="helper">Tip: puedes cambiar el cliente después desde la venta.</div>
    </mat-card>
  </section>

  <section class="actions-grid">
    <mat-card class="action" (click)="irAVenta()">
      <div class="icon-circle"><mat-icon>play_circle</mat-icon></div>
      <div>
        <div class="label">Nueva venta</div>
        <div class="hint">Ingresa productos y cobra</div>
      </div>
    </mat-card>

    <mat-card class="action" (click)="irAHistorial()">
      <div class="icon-circle"><mat-icon>history</mat-icon></div>
      <div>
        <div class="label">Historial diario</div>
        <div class="hint">Revisa movimientos de hoy</div>
      </div>
    </mat-card>

    <mat-card class="action" (click)="irAReportes()">
      <div class="icon-circle"><mat-icon>insights</mat-icon></div>
      <div>
        <div class="label">Reportes</div>
        <div class="hint">Descarga PDF y totales</div>
      </div>
    </mat-card>

    <mat-card class="action" (click)="irAClientes()">
      <div class="icon-circle"><mat-icon>people</mat-icon></div>
      <div>
        <div class="label">Clientes</div>
        <div class="hint">Gestiona fichas y contactos</div>
      </div>
    </mat-card>
  </section>
</div>